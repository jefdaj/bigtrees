use Data.Byteable instead of this "prettyHashLine" business?
test whether you can round-trip ShortByteStrings <--> actual filenames, then bother with the rest!
